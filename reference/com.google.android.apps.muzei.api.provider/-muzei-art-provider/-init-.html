<HTML>
<HEAD>
<meta charset="UTF-8">
<title>MuzeiArtProvider.<init> - muzei-api</title>
<link rel="stylesheet" href="../../../style.css">
</HEAD>
<BODY>
<a href="../../index.html">muzei-api</a>&nbsp;/&nbsp;<a href="../index.html">com.google.android.apps.muzei.api.provider</a>&nbsp;/&nbsp;<a href="index.html">MuzeiArtProvider</a>&nbsp;/&nbsp;<a href="./-init-.html">&lt;init&gt;</a><br/>
<br/>
<h1>&lt;init&gt;</h1>
<a name="com.google.android.apps.muzei.api.provider.MuzeiArtProvider$&lt;init&gt;()"></a>
<code><span class="identifier">MuzeiArtProvider</span><span class="symbol">(</span><span class="symbol">)</span></code>
<p>Base class for a Muzei Live Wallpaper artwork provider. Art providers are a way for other apps to
feed wallpapers (called <a href="../-artwork/index.html">artworks</a>) to Muzei Live Wallpaper.</p>
<h3>Subclassing <a href="index.html">MuzeiArtProvider</a></h3>
<p>Subclasses must implement at least the <a href="on-load-requested.html">onLoadRequested</a> callback
method, which is called whenever Muzei has displayed all available artwork from your provider.
It is strongly recommended to load new artwork at this point and add it via
<a href="add-artwork.html">addArtwork</a> so that users can continue to move to the next artwork.</p>
<p>All artwork added via <a href="add-artwork.html">addArtwork</a> is available to Muzei. Muzei controls how
often the artwork changes and the order that it proceeds through the artwork. As a
convenience, you can use <a href="set-artwork.html">setArtwork</a> to remove all artwork and set just a
single new <a href="../-artwork/index.html">Artwork</a>. You can use <a href="https://developer.android.com/reference/android/content/ContentResolver.html#delete(android.net.Uri, java.lang.String, java.lang.String[])">ContentResolver.delete</a> with <a href="content-uri.html">contentUri</a> to delete
specific artwork based on criteria of your choosing.</p>
<p>Many operations are also available in <a href="../-provider-contract/-artwork/index.html">ProviderContract.Artwork</a>, allowing you to add,
update, delete, and query for artwork from anywhere in your app.</p>
<h3>Registering your provider</h3>
<p>Each provider must be added to your application's <code>AndroidManifest.xml</code> file via a
<code>&lt;provider&gt;</code> element.</p>
<p>The Muzei app discover available providers using Android's <a href="https://developer.android.com/reference/android/content/Intent.html">Intent</a> mechanism. Ensure
that your <code>provider</code> definition includes an <code>&lt;intent-filter&gt;</code> with
an action of <a href="-a-c-t-i-o-n_-m-u-z-e-i_-a-r-t_-p-r-o-v-i-d-e-r.html">ACTION_MUZEI_ART_PROVIDER</a>. It is strongly recommended to protect access
to your provider's data by adding the <a href="-a-c-c-e-s-s_-p-e-r-m-i-s-s-i-o-n.html">ACCESS_PERMISSION</a>, which will
ensure that only your app and Muzei can access your data.</p>
<p>Lastly, there are a few <code>&lt;meta-data&gt;</code> elements that you should add to your
provider definition:</p>
<ul><li><code>settingsActivity</code> (optional): if present, should be the qualified
component name for a configuration activity in the provider's package that Muzei can offer
to the user for customizing the extension. This activity must be exported.</li>
<li><code>setupActivity</code> (optional): if present, should be the qualified
component name for an initial setup activity that must be ran before the provider can be
activated. It will be started with <a href="https://developer.android.com/reference/android/app/Activity.html#startActivityForResult(android.content.Intent, int)">android.app.Activity.startActivityForResult</a> and must
return <a href="https://developer.android.com/reference/android/app/Activity.html#RESULT_OK">android.app.Activity.RESULT_OK</a> for the provider to be activated. This activity
must be exported.</li>
</ul>
<h3>Example</h3>
<p>Below is an example provider declaration in the manifest:</p>
<pre><code>&lt;provider android:name=".ExampleArtProvider"
  android:authorities="com.example.artprovider"
  android:label="@string/source_title"
  android:description="@string/source_description"
  android:permission="com.google.android.apps.muzei.api.ACCESS_PROVIDER"&gt;
  &lt;intent-filter&gt;
    &lt;action android:name="com.google.android.apps.muzei.api.MuzeiArtProvider" /&gt;
  &lt;/intent-filter&gt;
  &lt;!-- A settings activity is optional --&gt;
  &lt;meta-data android:name="settingsActivity"
    android:value=".ExampleSettingsActivity" /&gt;
&lt;/provider&gt;
</code></pre>
<p>If a <code>settingsActivity</code> meta-data element is present, an activity with the given
component name should be defined and exported in the application's manifest as well. Muzei
will set the <a href="-e-x-t-r-a_-f-r-o-m_-m-u-z-e-i.html">EXTRA_FROM_MUZEI</a> extra to true in the launch intent for this
activity. An example is shown below:</p>
<pre><code>&lt;activity android:name=".ExampleSettingsActivity"
  android:label="@string/title_settings"
  android:exported="true" /&gt;
</code></pre>
<p>Finally, below is a simple example <a href="index.html">MuzeiArtProvider</a> subclass that publishes a single,
static artwork:</p>
<pre><code>class ExampleArtProvider : MuzeiArtProvider() {
  override fun onLoadRequested(initial: Boolean) {
    if (initial) {
      setArtwork(Artwork(
          title = "Example image",
          byline = "Unknown person, c. 1980",
          persistentUri = Uri.parse("http://example.com/image.jpg"),
          webUri = Uri.parse("http://example.com/imagedetails.html")))
    }
  }
}
</code></pre>
<p>As onLoadRequested can be called at any time (including when offline), it is
strongly recommended to use the callback of onLoadRequested to kick off
a load operation using <code>WorkManager</code>, <code>JobScheduler</code>, or a comparable API. These
other components can then use a <a href="../-provider-client/index.html">ProviderClient</a> and
<a href="../-provider-client/add-artwork.html">ProviderClient.addArtwork</a> to add Artwork to the MuzeiArtProvider.</p>
<h3>Additional notes</h3>
<p>Providers can also expose additional user-facing commands (such as 'Share artwork') by
returning one or more <a href="https://developer.android.com/reference/androidx/core/app/RemoteActionCompat.html">RemoteActionCompat</a> instances from <a href="get-command-actions.html">getCommandActions</a>.</p>
<p>Providers can provide a dynamic description of the current configuration (e.g.
'Popular photos tagged "landscape"'), by overriding <a href="get-description.html">getDescription</a>. By default,
the <code>android:description</code> element of the provider element in the manifest will be
used.</p>
<p>All artwork should support opening an Activity to view more details about the artwork.
You can provider your own functionality by overriding <a href="get-artwork-info.html">getArtworkInfo</a>.</p>
<p>If custom behavior is needed to retrieve the artwork's binary data (for example,
authentication with a remote server), this behavior can be added to
<a href="open-file.html">openFile</a>. If you already have binary data available locally for your
artwork, you can also write it directly via <a href="https://developer.android.com/reference/android/content/ContentResolver.html#openOutputStream(android.net.Uri)">ContentResolver.openOutputStream</a>.</p>
<p>It is strongly recommended to add a <a href="../-muzei-art-documents-provider/index.html">MuzeiArtDocumentsProvider</a> to your manifest to make
artwork from your MuzeiArtProvider available via the default file picker and Files app.</p>
<p>MuzeiArtProvider respects <a href="https://developer.android.com/reference/android/util/Log.html#isLoggable(java.lang.String, int)">Log.isLoggable</a> for debug logging, allowing you to
use <code>adb shell setprop log.tag.MuzeiArtProvider VERBOSE</code> to enable logging of the
communications between Muzei and your MuzeiArtProvider.</p>
</BODY>
</HTML>
